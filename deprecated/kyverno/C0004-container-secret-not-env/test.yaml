# SPDX-FileCopyrightText: Copyright (C) Nicolas Lamirault <nicolas.lamirault@gmail.com>
# SPDX-License-Identifier: Apache-2.0

name: test-portefaix-C0004
policies:
  -  policy-C0004.yaml
resources:
  -  resource.yaml
results:
  - policy: portefaix-C0004
    rule: secrets-not-from-env-vars
    resource: myapp-pod-ko-1
    kind: Pod
    status: fail
  - policy: portefaix-C0004
    rule: secrets-not-from-envfrom
    resource: myapp-pod-ko-2
    kind: Pod
    status: fail
  - policy: portefaix-C0004
    rule: secrets-not-from-env-vars
    resource: myapp-pod-ok
    kind: Pod
    status: pass
  - policy: portefaix-C0004
    rule: secrets-not-from-envfrom
    resource: myapp-pod-ok
    kind: Pod
    status: pass
